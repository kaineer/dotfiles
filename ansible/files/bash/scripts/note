#!/usr/bin/env bash

export BIN=$(readlink -f $0)
export DIR=$(dirname $BIN)
export DDIR="$DIR/note.d"
export BITS_REPO="git@github.com:kaineer/bits.git"
export BITS_DIR="$HOME/git/bits"

case "$1" in
"new") source "$DDIR/new_note" ;;
"clone") source "$DDIR/clone_repo" ;;
"sync")
  shift
  export DF_DIR="$BITS_DIR"
  source "$DDIR/sync" $@
  ;;
"bro" | "browse")
  cd $BITS_DIR
  gh browse
  ;;
"x")
  cd "$BITS_DIR"
  shift
  eval "$@"
  ;;
"y" | "year")
  F=$(date +%Y/)
  FILE=$(fd -tf | fzf -q"$F")
  [[ "$FILE" != "" ]] && nvim $FILE
  ;;
"m" | "mon" | "month")
  F=$(date +%Y/%m)
  FILE=$(fd -tf | fzf -q"$F")
  [[ "$FILE" != "" ]] && nvim $FILE
  ;;
"d" | "kyo")
  F=$(date +%Y/%m%d)
  FILE=$(fd -tf | fzf -q"$F")
  [[ "$FILE" != "" ]] && nvim $FILE
  ;;
"")
  FILE=$(fd -tf | fzf)
  [[ "$FILE" != "" ]] && nvim $FILE
  ;;
esac
